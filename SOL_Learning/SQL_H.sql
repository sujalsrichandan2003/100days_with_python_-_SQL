CREATE DATABASE Huron1;
USE Huron1;
CREATE TABLE LOCATION (
	Location_ID INT primary key,
    Regional_Name VARCHAR(100) NOT NULL
);

CREATE TABLE DEPARTMENT (
    Department_ID INT PRIMARY KEY,
    Name VARCHAR(100) NOT NULL,
    Location_ID INT NOT NULL,
    FOREIGN KEY (Location_ID) REFERENCES LOCATION(Location_ID)
);

CREATE TABLE JOB (
    Job_ID INT PRIMARY KEY,
    Functions VARCHAR(100) NOT NULL
);

CREATE TABLE EMPLOYEE (
    EMPLOYEE_ID INT PRIMARY KEY,
    LAST_NAME VARCHAR(100),
    FIRST_NAME VARCHAR(100),
    MIDDLE_NAME VARCHAR(100),
    JOB_ID INT NOT NULL,
    MANAGER_ID INT,
    HIREDATE DATE,
    SALARY INT NOT NULL,
    COMM INT,
    DEPARTMENT_ID INT,
    FOREIGN KEY (JOB_ID) REFERENCES JOB(Job_ID),
    FOREIGN KEY (DEPARTMENT_ID) REFERENCES DEPARTMENT(Department_ID)
);

SELECT*FROM EMPLOYEE;

INSERT INTO LOCATION
(Location_ID, Regional_Name)
VALUES
(122,'NEW YORK'),
(123, 'DALLAS'),
(124, 'CHICAGO'),
(167, 'BOSTON');

INSERT INTO DEPARTMENT
(Department_ID, Name ,Location_ID )
VALUES
(10,'ACCOUNTING', 122),
(20, 'RESEARCH', 124),
(30, 'SALES', 124),
(40, 'OPERATIONS', 167);

UPDATE DEPARTMENT
SET Location_ID = 123
WHERE Department_ID = 30;

INSERT INTO JOB
(Job_ID, Functions)
VALUES 
(667, 'CLERK'),
(668, 'STAFF'),
(669, 'ANALYST'),
(670, 'SALESPERSON'),
(671, 'MANAGER'),
(672, 'PRESIDENT');

INSERT INTO EMPLOYEE
(EMPLOYEE_ID,LAST_NAME,FIRST_NAME,MIDDLE_NAME,JOB_ID,MANAGER_ID,HIREDATE ,SALARY,COMM ,DEPARTMENT_ID)
VALUES
(7369, 'SMITH', 'JOHN', 'Q', 667, 7902, '1984-12-17', 800, NULL, 20),
(7499, 'ALLEN', 'KEVIN', 'J', 670, 7698, '1985-02-20', 1600, 300, 30),
(7505, 'DOYLE', 'JEAN', 'K', 671, 7839, '1985-04-04', 2850, NULL, 30),
(7506, 'DENNIS', 'LYNN', 'S', 671, 7839, '1985-05-15', 2750, NULL, 30),
(7507, 'BAKER', 'LESLIE', 'D', 671, 7839, '1985-06-10', 2200, NULL, 40),
(7521, 'WARK', 'CYNTHIA', 'D', 670, 7698, '1985-02-22', 1250, 500, 30);

# Q1
SELECT * FROM EMPLOYEE;

# Q2
SELECT * FROM DEPARTMENT;

# Q3
SELECT * FROM JOB;

# Q4
SELECT * FROM LOCATION;

# Q5
SELECT FIRST_NAME,LAST_NAME,SALARY,COMM FROM EMPLOYEE;

# Q6
SELECT 
	EMPLOYEE_ID AS "ID of employees", 
    LAST_NAME AS "Name of the employee", 
    DEPARTMENT_ID AS "department ID"
FROM EMPLOYEE;

# Q7
SELECT SALARY, FIRST_NAME FROM EMPLOYEE;

# Q8
SELECT * FROM EMPLOYEE
WHERE EMPLOYEE_ID = 7369;

# Q9
SELECT * FROM EMPLOYEE
WHERE DEPARTMENT_ID = 20;

# Q10
SELECT * FROM EMPLOYEE
WHERE SALARY BETWEEN 3000 AND 4500;

# Q11
SELECT * FROM EMPLOYEE
WHERE DEPARTMENT_ID=10 OR DEPARTMENT_ID=20;
#OR WE WRITE LIKE THIS BOTH ARE CORRECT
SELECT * FROM EMPLOYEE
WHERE DEPARTMENT_ID IN (10, 20);

# Q12
SELECT * FROM EMPLOYEE
WHERE DEPARTMENT_ID NOT IN (10, 30);

# Q13
SELECT * FROM EMPLOYEE 
WHERE LAST_NAME LIKE 'S%';

# Q14
SELECT * FROM EMPLOYEE
WHERE LAST_NAME LIKE 'S%H';

# Q15
SELECT * FROM EMPLOYEE
WHERE LAST_NAME LIKE  'S___';

# Q16
SELECT * FROM EMPLOYEE
WHERE DEPARTMENT_ID = 10 AND SALARY>3500;

# Q17
SELECT * FROM EMPLOYEE
WHERE COMM IS NOT NULL;

# Q18
SELECT EMPLOYEE_ID, LAST_NAME FROM EMPLOYEE
ORDER BY EMPLOYEE_ID ASC;

# Q19
SELECT SALARY FROM EMPLOYEE
ORDER BY SALARY DESC;

# Q 20
SELECT LAST_NAME, SALARY FROM EMPLOYEE
ORDER BY LAST_NAME ASC ,SALARY DESC;

# Q21
SELECT LAST_NAME, DEPARTMENT_ID FROM EMPLOYEE
ORDER BY LAST_NAME ASC , DEPARTMENT_ID DESC;

# Q22
SELECT DEPARTMENT_ID , COUNT(*) AS EMPLOYEES
FROM EMPLOYEE
GROUP BY DEPARTMENT_ID;

# Q23
SELECT DEPARTMENT_ID , MAX(SALARY) AS MAX_SALARY, MIN(SALARY), AVG(SALARY)
FROM EMPLOYEE
GROUP BY DEPARTMENT_ID;

# Q24
SELECT JOB_ID, MAX(SALARY) AS MAX_SALARY, MIN(SALARY), AVG(SALARY)
FROM EMPLOYEE
GROUP BY JOB_ID;

# Q25
SELECT MONTH(HIREDATE) AS month,
       COUNT(*) AS employee_count
FROM EMPLOYEE
GROUP BY MONTH(HIREDATE)
ORDER BY month ASC;


# Q26
SELECT MONTH(HIREDATE) AS month,
	   YEAR(HIREDATE) AS year,
       COUNT(*) AS employee_count
FROM EMPLOYEE
GROUP BY MONTH(HIREDATE), YEAR(HIREDATE)
ORDER BY month ASC;

# Q27
SELECT DEPARTMENT_ID, COUNT(*) AS employee_count FROM EMPLOYEE
GROUP BY DEPARTMENT_ID
HAVING COUNT(*) >= 4;

# Q28
SELECT COUNT(*) AS january_count
FROM EMPLOYEE
WHERE MONTH(HIREDATE) = 1;

# Q29
SELECT COUNT(*) AS january_count
FROM EMPLOYEE
WHERE MONTH(HIREDATE) IN (1,8);


# Q30
SELECT YEAR(HIREDATE) AS YEARS, COUNT(*) AS Employee_Count
GROUP BY YEAR(HIREDATE)
HAVING YEAR = 1985;

# Q 48
SELECT * FROM EMPLOYEE



